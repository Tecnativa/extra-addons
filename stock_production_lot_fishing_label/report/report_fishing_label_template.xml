<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <!--  Complete fishing labels  -->
    <template id="label_fishing_report_document_scientific">
        <span>Scientific N.</span>
    </template>
    <template id="label_fishing_report_document_fish_zone">
        <span>Fishing zone</span>
    </template>
    <template id="label_fishing_report_document_production_method">
        <span>Production method</span>
    </template>
    <template id="label_fishing_report_document_fishing_art">
        <span>Fishing art</span>
    </template>
    <template id="label_fishing_report_document_boat">
        <span>Boat</span>
    </template>
    <template id="label_fishing_report_document_origin">
        <span>Origin</span>
    </template>
    <template id="label_fishing_report_document_presentation">
        <span>Presentation</span>
    </template>
    <template id="label_fishing_report_document_keep_at">
        <span>Keep at</span>
    </template>
    <template id="label_fishing_report_document_elaboration_country">
        <span>Manufacturing country</span>
    </template>
    <template id="label_fishing_report_document_nutrition_facts">
        <div class="row">
            <t
                t-set="show_nutritional_table"
                t-value="show_nutritional_table or product.gamma_ids[:1] != env.ref('product_fishing.product_gamma_f')"
            />
            <div
                t-att-class="'col-9' if show_nutritional_table and (lot.nutritional_value_ids or product.nutritional_value_ids) else 'col-12'"
                id="conservation"
            />
            <div
                style="font-size: 10pt"
                class="col-3 pt-1"
                id="nutritional_table"
                t-if="show_nutritional_table and (lot.nutritional_value_ids or product.nutritional_value_ids)"
            >
                <t t-call="nutritional_info.nutritional_info_table">
                    <t t-set="main_object" t-value="lot" />
                    <t t-set="alt_object" t-value="product" />
                    <t t-set="langs" t-value="report_langs[doc['id']]" />
                </t>
            </div>
        </div>
    </template>
    <template id="label_fishing_report_document">
        <t t-call="stock_production_lot_fishing_label.basic_layout_fishing_label">
            <t
                t-set="show_client_elaborations"
                t-value="client_elaborations[doc['id']]"
            />
            <t t-set="lot" t-value="doc['lot_id']" />
            <t t-set="product" t-value="doc['product_id']" />
            <t
                t-set="count"
                t-value="doc['label_qty'] if doc_model == 'stock.picking.line.print' else 1"
            />
            <t t-foreach="count" t-as="i">
                <div class="page" style="font-size: 18pt;">
                    <t t-set="langs" t-value="report_langs[doc['id']]" />
                    <table style="width: 100%">
                        <thead>
                            <tr><td><br /></td></tr>
                            <tr t-if="show_client_elaborations">
                                <td class="text-center">
                                    <strong
                                        style="font-size: 20pt;"
                                        t-if="doc_model not in ['stock.quant', 'stock.picking.line.print']"
                                        t-field="doc['picking_partner_id'].name"
                                    />
                                    <strong
                                        style="font-size: 20pt;"
                                        t-elif="doc_model == 'stock.picking.line.print'"
                                        t-field="doc['move_line_id'].picking_partner_id.name"
                                    />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="float-left" style="max-width: 900px">
                                        <t t-foreach="langs" t-as="lang">
                                            <strong
                                                t-attf-style="font-size: {{'17pt' if lang_index &gt; 1 else '23pt'}}; display: block; line-height:100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
                                            >
                                                <span
                                                    t-field="product.with_context(lang=lang).name"
                                                />
                                                <t t-if="product.caliber_ids">
                                                    <t t-if="lang != 'ar_001'">(</t>
                                                    <span
                                                        t-field="product.product_template_variant_value_ids.filtered(lambda value: value.attribute_id == env.ref('product_attribute_value_range.attribute_caliber')).with_context(lang=lang).name"
                                                    /><t t-if="lang != 'ar_001'">)</t>
                                                </t>
                                            </strong>
                                        </t>
                                    </div>
                                    <div
                                        class="float-right text-center pl-2 pr-2"
                                        style="width: 400px"
                                    >
                                        <t
                                            t-if="doc_model != 'stock.quant' and not summarized"
                                        >
                                            <t
                                                t-set="package_barcode"
                                                t-value="doc['result_package_id'].name"
                                            />
                                            <t
                                                t-set="package_barcode_name"
                                                t-value="doc['result_package_id'].alias or doc['result_package_id'].name"
                                            />
                                        </t>
                                        <t
                                            t-elif="doc_model == 'stock.quant' and not summarized"
                                        >
                                            <t
                                                t-set="package_barcode"
                                                t-value="doc['package_id'].name"
                                            />
                                            <t
                                                t-set="package_barcode_name"
                                                t-value="doc['package_id'].alias or doc['package_id'].name"
                                            />
                                        </t>
                                        <t t-if="package_barcode">
                                            <img
                                                t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s' % ('gs1_128', package_barcode, 600, 100)"
                                                style="width:100%;height:75px;"
                                                alt="Barcode"
                                            />
                                            <span
                                                style="font-size: 12pt"
                                                t-out="package_barcode_name"
                                            />
                                        </t>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td
                                    class="text-right"
                                    style="font-size: 15pt;"
                                    id="extra_heading"
                                >
                                    <div
                                        t-if="show_client_elaborations and doc_model not in ['stock.quant', 'stock.picking.line.print'] and doc['move_id'].elaboration_ids"
                                    >
                                        <i
                                            t-out="', '.join(doc['move_id'].elaboration_ids.with_context(lang='ca_ES').mapped(lambda e: '*' + e.name))"
                                        />
                                        <br />
                                        <i t-out="doc['move_id'].elaboration_note" />
                                    </div>
                                    <div
                                        t-elif="show_client_elaborations and doc_model == 'stock.picking.line.print' and doc['move_line_id'].elaboration_ids"
                                    >
                                        <i
                                            t-out="', '.join(doc['move_line_id'].move_id.elaboration_ids.with_context(lang='ca_ES').mapped(lambda e: '*' + e.name))"
                                        />
                                        <br />
                                        <i
                                            t-out="doc['move_line_id'].move_id.elaboration_note"
                                        />
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <t
                                        t-set="precision"
                                        t-value="env['decimal.precision'].precision_get('Product Unit of Measure')"
                                    />
                                    <table
                                        class="text-center"
                                        style="border-top: 1px solid black;border-bottom: 1px solid black;font-size: 18pt;width:100%;line-height:100%;"
                                    >
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <t t-foreach="langs" t-as="lang">
                                                        <t
                                                            t-call="stock_production_lot_fishing_label.basic_layout_fishing_label_freezing"
                                                            t-lang="lang"
                                                        />
                                                        <span
                                                            t-if="lang != langs[-1]"
                                                        > / </span>
                                                    </t>
                                                </td>
                                                <td>
                                                    <t t-foreach="langs" t-as="lang">
                                                        <t
                                                            t-call="stock_production_lot_fishing_label.basic_layout_fishing_label_expiration"
                                                            t-lang="lang"
                                                        />
                                                        <span
                                                            t-if="lang != langs[-1]"
                                                        > / </span>
                                                    </t>
                                                </td>
                                                <td>
                                                    <t t-foreach="langs" t-as="lang">
                                                        <t
                                                            t-call="stock_production_lot_fishing_label.basic_layout_fishing_label_lot_num"
                                                            t-lang="lang"
                                                        />
                                                        <span
                                                            t-if="lang != langs[-1]"
                                                        > / </span>
                                                    </t>
                                                </td>
                                                <td>
                                                    <t t-foreach="langs" t-as="lang">
                                                        <t
                                                            t-call="stock_production_lot_fishing_label.basic_layout_fishing_label_net_weight"
                                                            t-lang="lang"
                                                        />
                                                        <span
                                                            t-if="lang != langs[-1]"
                                                        > / </span>
                                                    </t>
                                                </td>
                                                <td
                                                    t-if="not float_is_zero(product.drained_weight, precision_digits=precision)"
                                                >
                                                    <t t-foreach="langs" t-as="lang">
                                                        <t
                                                            t-call="stock_production_lot_fishing_label.basic_layout_fishing_label_drained_weight"
                                                            t-lang="lang"
                                                        />
                                                        <span
                                                            t-if="lang != langs[-1]"
                                                        > / </span>
                                                    </t>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <strong
                                                        t-field="lot.packaging_date"
                                                        t-options='{"widget": "date"}'
                                                    />
                                                </td>
                                                <td>
                                                    <strong
                                                        t-field="lot.expiration_date"
                                                        t-options='{"widget": "date"}'
                                                    />
                                                </td>
                                                <td style="font-size: 22pt"><strong
                                                        t-field="lot.display_name"
                                                    /></td>
                                                <t
                                                    t-set="uom"
                                                    t-value="doc['product_uom_id'] if doc_model != 'stock.picking.line.print' else doc['uom_id']"
                                                />
                                                <t
                                                    t-set="net_weight"
                                                    t-value="product.net_weight if not product.qty_per_packaging or product.weight_type == 'fixed' else product.net_weight/product.qty_per_packaging"
                                                />
                                                <td>
                                                    <t
                                                        t-if="uom.category_id == env.ref('uom.product_uom_categ_kgm')"
                                                    >
                                                        <strong
                                                            t-if="doc_model in ['stock.quant', 'stock.picking.line.print']"
                                                            t-out="round(doc['quantity'], 2)"
                                                        />
                                                        <strong
                                                            t-else=""
                                                            t-out="round(doc['qty_done'], 2)"
                                                        />
                                                        <strong
                                                            t-field="uom.display_name"
                                                        />
                                                    </t>
                                                    <t t-else="">
                                                        <strong
                                                            t-if="doc_model in ['stock.quant', 'stock.picking.line.print']"
                                                            t-out="round(doc['quantity'] * net_weight, 2)"
                                                        />
                                                        <strong
                                                            t-else=""
                                                            t-out="round(doc['qty_done'] * net_weight, 2)"
                                                        />
                                                        <strong
                                                            t-field="product.weight_uom_name"
                                                        />
                                                    </t>
                                                </td>
                                                <td
                                                    t-if="not float_is_zero(product.drained_weight, precision_digits=precision)"
                                                >
                                                    <t
                                                        t-if="uom.category_id == env.ref('uom.product_uom_categ_kgm')"
                                                    >
                                                        <strong
                                                            t-if="doc_model in ['stock.quant', 'stock.picking.line.print'] and not float_is_zero(net_weight, precision_digits=precision)"
                                                            t-out="round(doc['quantity'] * (product.drained_weight / net_weight), 2)"
                                                        />
                                                        <strong
                                                            t-elif="not float_is_zero(net_weight, precision_digits=precision)"
                                                            t-out="round(doc['qty_done'] * (product.drained_weight / net_weight), 2)"
                                                        />
                                                        <strong
                                                            t-else=""
                                                            t-out="round(net_weight, 2)"
                                                        />
                                                        <strong
                                                            t-field="uom.display_name"
                                                        />
                                                    </t>
                                                    <t t-else="">
                                                        <strong
                                                            t-if="doc_model in ['stock.quant', 'stock.picking.line.print']"
                                                            t-out="round(doc['quantity'] * product.drained_weight, 2)"
                                                        />
                                                        <strong
                                                            t-else=""
                                                            t-out="round(doc['qty_done'] * product.drained_weight, 2)"
                                                        />
                                                        <strong
                                                            t-field="product.weight_uom_name"
                                                        />
                                                    </t>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                            </tr>
                        </thead>
                        <tbody style="line-height:100%">
                            <tr>
                                <td>
                                    <div class="row" id="scientific_name">
                                        <div class="col-6">
                                            <t t-foreach="langs" t-as="lang">
                                                <t
                                                    t-call="stock_production_lot_fishing_label.label_fishing_report_document_scientific"
                                                    t-lang="lang"
                                                />
                                                <span
                                                    t-if="lang != langs[-1]"
                                                > / </span>
                                            </t>
                                        </div>
                                        <div
                                            class="col-6"
                                            style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
                                        >
                                            <strong><i
                                                    t-field="product.scientific_name_ids[:1].name"
                                                /></strong>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="row" id="fishing_zone">
                                        <div class="col-6">
                                            <t t-foreach="langs" t-as="lang">
                                                <t
                                                    t-call="stock_production_lot_fishing_label.label_fishing_report_document_fish_zone"
                                                    t-lang="lang"
                                                />
                                                <span
                                                    t-if="lang != langs[-1]"
                                                > / </span>
                                            </t>
                                        </div>
                                        <div
                                            class="col-6"
                                            style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
                                        >
                                            <strong
                                                t-out="get_multilang_limited_value(langs, lot.fao_fishing_area_id, 'name', ' / ', limit=57)"
                                            />
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="row" id="production_method">
                                        <div class="col-6">
                                            <t t-foreach="langs" t-as="lang">
                                                <t
                                                    t-call="stock_production_lot_fishing_label.label_fishing_report_document_production_method"
                                                    t-lang="lang"
                                                />
                                                <span
                                                    t-if="lang != langs[-1]"
                                                > / </span>
                                            </t>
                                        </div>
                                        <div
                                            class="col-6"
                                            style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
                                        >
                                            <strong
                                                t-out="get_multilang_limited_value(langs, lot.harvesting_id, 'name', ' / ', limit=57)"
                                            />
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="row" id="fishing_art">
                                        <div class="col-6">
                                            <t t-foreach="langs" t-as="lang">
                                                <t
                                                    t-call="stock_production_lot_fishing_label.label_fishing_report_document_fishing_art"
                                                    t-lang="lang"
                                                />
                                                <span
                                                    t-if="lang != langs[-1]"
                                                > / </span>
                                            </t>
                                        </div>
                                        <div
                                            class="col-6"
                                            style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
                                        >
                                            <strong
                                                t-out="get_multilang_limited_value(langs, lot.fao_fishing_technique_id, 'name', ' / ', limit=57)"
                                            />
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="row" id="boat">
                                        <div class="col-6">
                                            <t t-foreach="langs" t-as="lang">
                                                <t
                                                    t-call="stock_production_lot_fishing_label.label_fishing_report_document_boat"
                                                    t-lang="lang"
                                                />
                                                <span
                                                    t-if="lang != langs[-1]"
                                                > / </span>
                                            </t>
                                        </div>
                                        <div
                                            class="col-6"
                                            style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
                                        >
                                            <strong
                                                t-field="lot.fishing_ship_id.name"
                                            />
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="row" id="origin">
                                        <div class="col-6">
                                            <t t-foreach="langs" t-as="lang">
                                                <t
                                                    t-call="stock_production_lot_fishing_label.label_fishing_report_document_origin"
                                                    t-lang="lang"
                                                />
                                                <span
                                                    t-if="lang != langs[-1]"
                                                > / </span>
                                            </t>
                                        </div>
                                        <div
                                            class="col-6"
                                            style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
                                        >
                                            <strong
                                                t-out="get_multilang_limited_value(langs, lot.country_id, 'name', ' / ', limit=57)"
                                            />
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="row" id="presentation">
                                        <div class="col-6">
                                            <t t-foreach="langs" t-as="lang">
                                                <t
                                                    t-call="stock_production_lot_fishing_label.label_fishing_report_document_presentation"
                                                    t-lang="lang"
                                                />
                                                <span
                                                    t-if="lang != langs[-1]"
                                                > / </span>
                                            </t>
                                        </div>
                                        <div
                                            class="col-6"
                                            style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
                                        >
                                            <strong
                                                t-out="get_multilang_limited_value(langs, lot.presentation_id, 'name', ' / ', limit=57)"
                                            />
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="row" id="keep_at">
                                        <div class="col-6">
                                            <t t-foreach="langs" t-as="lang">
                                                <t
                                                    t-call="stock_production_lot_fishing_label.label_fishing_report_document_keep_at"
                                                    t-lang="lang"
                                                />
                                                <span
                                                    t-if="lang != langs[-1]"
                                                > / </span>
                                            </t>
                                        </div>
                                        <div
                                            class="col-6"
                                            style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
                                        >
                                            <strong
                                                t-out="'0-4ºC' if product.gamma_ids[:1] != env.ref('product_fishing.product_gamma_c') else '-18ºC'"
                                            />
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr
                                t-if="product.attribute_line_ids.filtered(lambda al: al.attribute_id == env.ref('stock_production_lot_fishing_info.manufacturing_country'))"
                            >
                                <td>
                                    <div class="row" id="elaboration_country">
                                        <div class="col-6">
                                            <t t-foreach="langs" t-as="lang">
                                                <t
                                                    t-call="stock_production_lot_fishing_label.label_fishing_report_document_elaboration_country"
                                                    t-lang="lang"
                                                />
                                                <span
                                                    t-if="lang != langs[-1]"
                                                > / </span>
                                            </t>
                                        </div>
                                        <div
                                            class="col-6"
                                            style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
                                        >
                                            <strong
                                                t-out="get_multilang_limited_value(langs, product.attribute_line_ids.filtered(lambda al: al.attribute_id == env.ref('stock_production_lot_fishing_info.manufacturing_country')).value_ids[:1], 'name', ' / ', limit=57)"
                                            />
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <t
                                    t-set="show_product_filtered"
                                    t-value="not product.filtered_domain(product_filter._get_eval_domain()) if product_filter.domain != '[]' else True"
                                />
                                <td
                                    t-if="use_second_page or (product.gamma_ids[:1] != env.ref('product_fishing.product_gamma_f') and show_product_filtered and 'ar_001' not in langs)"
                                >
                                    <t
                                        t-call="stock_production_lot_fishing_label.label_fishing_report_document_nutrition_facts"
                                    />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div style="page-break-before:always;" />
                </div>
            </t>
        </t>
    </template>
    <template id="label_fishing">
        <t t-foreach="docs" t-as="doc">
            <t
                t-call="stock_production_lot_fishing_label.label_fishing_report_document"
            />
        </t>
    </template>
    <template id="label_fishing_move">
        <t t-foreach="docs" t-as="doc">
            <t
                t-call="stock_production_lot_fishing_label.label_fishing_report_document"
            />
        </t>
    </template>
    <template id="label_fishing_quant">
        <t t-foreach="docs" t-as="doc">
            <t
                t-call="stock_production_lot_fishing_label.label_fishing_report_document"
            />
        </t>
    </template>
    <template id="label_fishing_nutri">
        <t t-foreach="docs" t-as="doc">
            <t
                t-call="stock_production_lot_fishing_label.label_fishing_report_document"
            />
        </t>
    </template>
    <!--  Mini fishing labels  -->
    <template id="label_fishing_report_mini_document">
        <t t-call="web.basic_layout">
            <t
                t-set="count"
                t-value="doc['label_qty'] if doc_model == 'stock.picking.line.print' else 1"
            />
            <t t-foreach="count" t-as="i">
                <div class="page">
                    <div class="row" style="padding-top: 25px">
                        <div class="col">
                            <t t-if="doc_model != 'stock.quant' and not summarized">
                                <t
                                    t-set="package_barcode"
                                    t-value="doc['result_package_id'].name"
                                />
                                <t
                                    t-set="package_barcode_name"
                                    t-value="doc['result_package_id'].alias or doc['result_package_id'].name"
                                />
                            </t>
                            <t t-elif="doc_model == 'stock.quant' and not summarized">
                                <t
                                    t-set="package_barcode"
                                    t-value="doc['package_id'].name"
                                />
                                <t
                                    t-set="package_barcode_name"
                                    t-value="doc['package_id'].alias or doc['package_id'].name"
                                />
                            </t>
                            <img
                                t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;quiet=0&amp;height=%s&amp;width=%s&amp;' % ('gs1_128', package_barcode, 60, 30)"
                                style="width:100%;height:100px"
                            />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col" style="text-align:center; font-size: 12pt;">
                            <span t-out="package_barcode_name" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col" style="text-align:center; font-size: 12pt;">
                            <strong t-out="doc['product_id'].name" />
                        </div>
                    </div>
                    <p style="page-break-before:always;" />
                </div>
            </t>
        </t>
    </template>
    <template id="label_fishing_mini">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t
                    t-call="stock_production_lot_fishing_label.label_fishing_report_mini_document"
                />
            </t>
        </t>
    </template>
    <template id="label_fishing_move_mini">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t
                    t-call="stock_production_lot_fishing_label.label_fishing_report_mini_document"
                />
            </t>
        </t>
    </template>
    <template id="label_fishing_quant_mini">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t
                    t-call="stock_production_lot_fishing_label.label_fishing_report_mini_document"
                />
            </t>
        </t>
    </template>
</odoo>
